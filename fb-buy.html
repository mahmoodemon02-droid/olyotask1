<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8" />
<title>Facebook Buy</title>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import {
  getFirestore,
  collection,
  getDocs,
  doc,
  updateDoc
} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDIETvBYGyPXKDYi_H7J4Fcxv2Ir_AN6M8",
  authDomain: "olyotaskbot-7019e.firebaseapp.com",
  projectId: "olyotaskbot-7019e",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const PRICE = 10;

window.onload = async () => {
  const list = document.getElementById("list");
  list.innerHTML = "‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";

  const snap = await getDocs(collection(db, "facebook_stock"));

  list.innerHTML = "";

  if (snap.empty) {
    list.innerHTML = "<p>‚ùå ‡¶ï‡ßã‡¶®‡ßã Facebook ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á</p>";
    return;
  }

  snap.forEach(docSnap => {
    const d = docSnap.data();
    if (d.sold) return;

    const div = document.createElement("div");
    div.style.background = "#2b145f";
    div.style.padding = "12px";
    div.style.marginBottom = "10px";
    div.style.borderRadius = "10px";

    const shortLogin =
      d.login.length > 6
        ? d.login.slice(0, 3) + "****" + d.login.slice(-2)
        : d.login;

    div.innerHTML = `
      <p>üîê ${shortLogin}</p>
      <button>BUY ${PRICE} ‡¶ü‡¶æ‡¶ï‡¶æ</button>
    `;

    div.querySelector("button").onclick = async () => {
      if (!confirm("‡ßß‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶ï‡ßá‡¶ü‡ßá ‡¶®‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡¶¨‡ßá, ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§?")) return;

      await updateDoc(doc(db, "facebook_stock", docSnap.id), {
        sold: true
      });

      div.innerHTML = `
        <p>üìß ${d.login}</p>
        <p>üîë ${d.pass}</p>
      `;
    };

    list.appendChild(div);
  });
};
</script>

<style>
body {
  background: #12002b;
  color: white;
  font-family: sans-serif;
  padding: 15px;
}
button {
  background: #00ff9c;
  border: none;
  padding: 8px 14px;
  border-radius: 20px;
  cursor: pointer;
}
</style>
</head>

<body>
<h2>Facebook Buy</h2>
<div id="list"></div>
</body>
</html>
